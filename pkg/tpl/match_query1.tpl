match (v)-[e1:KNOWS]->(v1) where id(v) == {{.Vid}} with distinct v1, timestamp(e1.creationDate) as one_hop_edge_strength order by one_hop_edge_strength desc limit 20 match (v1)-[e2:KNOWS]->(v2) with distinct v1, one_hop_edge_strength, v2, timestamp(e2.creationDate) as tmp_two_hop_edge_strength with distinct v2,tmp_two_hop_edge_strength+one_hop_edge_strength as two_hop_edge_strength order by two_hop_edge_strength desc limit 100 match (v2)-[e3:KNOWS]->(v3) with distinct v2, two_hop_edge_strength, v3,  timestamp(e3.creationDate) as tmp_three_hop_edge_strength with distinct v3, tmp_three_hop_edge_strength+two_hop_edge_strength as three_hop_edge_strength order by three_hop_edge_strength desc limit 2000 return DISTINCT id(v3) as three_hop_id
